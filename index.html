<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Mochkil Snack Frenzy Mobile Demo</title>
<style>
    body {
        display: flex;
        flex-direction: column;
        align-items: center;
        margin: 0;
        background-color: #fef4e0;
    }
    canvas {
        border: 2px solid #333;
        background-color: #fef4e0;
        margin-top: 20px;
    }
    .controls {
        margin-top: 10px;
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
    }
    button {
        font-size: 18px;
        padding: 10px 15px;
        border-radius: 8px;
        border: none;
        background-color: #ffcc80;
        cursor: pointer;
    }
    button:active {
        background-color: #ffa726;
    }
</style>
</head>
<body>

<canvas id="gameCanvas" width="800" height="600"></canvas>

<div class="controls">
    <button id="leftBtn">‚¨ÖÔ∏è Left</button>
    <button id="rightBtn">‚û°Ô∏è Right</button>
    <button id="eatBtn">üç∞ Eat</button>
    <button id="comaBtn">üí§ Plop</button>
    <button id="throwBtn">üç∞ Throw</button>
</div>

<script>
// === Canvas Setup ===
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");

// === Load Mochkil Sprites ===
const sprites = {
    idle: new Image(),
    walkLeft: new Image(),
    walkRightCake: new Image(),
    eatLeft: new Image(),
    foodComa: new Image()
};

sprites.idle.src = "mochkil_idle.png";
sprites.walkLeft.src = "mochkil_left.png";
sprites.walkRightCake.src = "mochkil_walk_right_cake.png";
sprites.eatLeft.src = "mochkil_eat_left.png";
sprites.foodComa.src = "mochkil_food_coma.png";

// === Game Variables ===
let mochkilX = 350;
const groundY = 300; // base standing Y
let mochkilY = groundY;
let currentSprite = "idle";
let facingEast = true;
let currentSnack = "üç∞"; // emoji snack
const canvasWidth = canvas.width;
const canvasHeight = canvas.height;

// === Throwing Slices ===
let slices = []; 

function throwSlice() {
    slices.push({
        x: mochkilX + 50,
        y: mochkilY + 20,
        dx: facingEast ? 6 : -6,
        emoji: currentSnack
    });
}

// === Draw Function ===
function drawMochkil() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    // Background
    ctx.fillStyle = "#ffe8b3";
    ctx.fillRect(0, 0, canvas.width, canvas.height);

    // Adjust Mochkil Y for food coma vs normal
    let drawY = mochkilY;
    if(currentSprite === "foodComa") {
        // Raise so full sprite fits on screen
        drawY = groundY - sprites.foodComa.height + 20; // 20px padding
    }

    // Mochkil sprite
    ctx.save();
    if(facingEast && (currentSprite === "walkLeft" || currentSprite === "eatLeft")){
        ctx.translate(mochkilX + 100, drawY);
        ctx.scale(-1, 1);
        ctx.drawImage(sprites[currentSprite], 0, 0);
    } else {
        ctx.drawImage(sprites[currentSprite], mochkilX, drawY);
    }
    ctx.restore();

    // Emoji snack in hand
    ctx.font = "40px serif";
    ctx.fillText(currentSnack, mochkilX + 20, drawY + 20);

    // Draw thrown slices
    slices.forEach(slice => {
        ctx.fillText(slice.emoji, slice.x, slice.y);
    });
}

// === Update Function ===
function update() {
    slices.forEach((slice, i) => {
        slice.x += slice.dx;
        if(slice.x < 0 || slice.x > canvasWidth) slices.splice(i,1);
    });
}

// === Button Controls ===
document.getElementById("leftBtn").addEventListener("touchstart", () => {
    currentSprite = "walkLeft";
    facingEast = false;
    mochkilX -= 10;
});
document.getElementById("rightBtn").addEventListener("touchstart", () => {
    currentSprite = "walkLeft"; // flipped
    facingEast = true;
    mochkilX += 10;
});
document.getElementById("eatBtn").addEventListener("touchstart", () => {
    currentSprite = "eatLeft";
});
document.getElementById("comaBtn").addEventListener("touchstart", () => {
    currentSprite = "foodComa";
});
document.getElementById("throwBtn").addEventListener("touchstart", throwSlice);

// Reset to idle on touchend
document.querySelectorAll("button").forEach(btn => {
    btn.addEventListener("touchend", () => {
        currentSprite = "idle";
    });
});

// Canvas boundaries
function clampPosition() {
    mochkilX = Math.max(0, Math.min(canvasWidth - 100, mochkilX));
    mochkilY = groundY;
}

// === Game Loop ===
function gameLoop(){
    clampPosition();
    update();
    drawMochkil();
    requestAnimationFrame(gameLoop);
}

gameLoop();
</script>
</body>
</html>
