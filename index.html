<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Mochkil Snack Frenzy Demo</title>
<style>
    canvas {
        border: 2px solid #333;
        background-color: #fef4e0; /* kitchen vibe */
        display: block;
        margin: 0 auto;
    }
</style>
</head>
<body>

<canvas id="gameCanvas" width="800" height="600"></canvas>

<script>
// === Canvas Setup ===
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");

// === Load Mochkil Sprites ===
const sprites = {
    idle: new Image(),
    walkLeft: new Image(),
    walkRightCake: new Image(),
    eatLeft: new Image(),
    foodComa: new Image()
};

sprites.idle.src = "mochkil_idle.png";
sprites.walkLeft.src = "mochkil_left.png";
sprites.walkRightCake.src = "mochkil_walk_right_cake.png";
sprites.eatLeft.src = "mochkil_eat_left.png";
sprites.foodComa.src = "mochkil_food_coma.png";

// === Game Variables ===
let mochkilX = 350;
let mochkilY = 400;
let currentSprite = "idle";
let facingEast = true;
let currentSnack = "ðŸ°"; // emoji snack
const canvasWidth = canvas.width;
const canvasHeight = canvas.height;

// === Throwing Slices (Frenzy Mode) ===
let slices = []; // array of thrown emoji slices

function throwSlice() {
    // slice starts at Mochkil's hand
    slices.push({
        x: mochkilX + 50,
        y: mochkilY + 20,
        dx: facingEast ? 6 : -6, // speed depends on direction
        emoji: "ðŸ°"
    });
}

// === Draw Function ===
function drawMochkil() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    // Background layer
    ctx.fillStyle = "#ffe8b3";
    ctx.fillRect(0, 0, canvas.width, canvas.height);

    // Mochkil sprite
    ctx.save();
    if(facingEast && (currentSprite === "walkLeft" || currentSprite === "eatLeft")){
        ctx.translate(mochkilX + 100, mochkilY);
        ctx.scale(-1, 1);
        ctx.drawImage(sprites[currentSprite], 0, 0);
    } else {
        ctx.drawImage(sprites[currentSprite], mochkilX, mochkilY);
    }
    ctx.restore();

    // Emoji snack in hand
    let emojiX = mochkilX + 20;
    let emojiY = mochkilY + 20;
    ctx.font = "40px serif";
    ctx.fillText(currentSnack, emojiX, emojiY);

    // Draw thrown slices
    slices.forEach(slice => {
        ctx.fillText(slice.emoji, slice.x, slice.y);
    });
}

// === Update Function ===
function update() {
    // Move thrown slices
    slices.forEach((slice, i) => {
        slice.x += slice.dx;
        // Remove slice if it leaves canvas
        if(slice.x < 0 || slice.x > canvasWidth){
            slices.splice(i,1);
        }
    });
}

// === Key Controls ===
document.addEventListener("keydown", (e) => {
    if(e.key === "ArrowLeft"){
        currentSprite = "walkLeft";
        facingEast = false;
        mochkilX -= 10;
    } else if(e.key === "ArrowRight"){
        currentSprite = "walkLeft"; // use walkLeft sprite flipped
        facingEast = true;
        mochkilX += 10;
    } else if(e.key === "ArrowUp"){
        currentSprite = "eatLeft";
    } else if(e.key === "ArrowDown"){
        currentSprite = "foodComa";
    } else if(e.key === " "){ // spacebar throws a slice
        throwSlice();
    }

    // Canvas boundaries
    mochkilX = Math.max(0, Math.min(canvasWidth - 100, mochkilX));
    mochkilY = Math.max(0, Math.min(canvasHeight - 100, mochkilY));
});

document.addEventListener("keyup", (e) => {
    currentSprite = "idle";
});

// === Game Loop ===
function gameLoop(){
    update();
    drawMochkil();
    requestAnimationFrame(gameLoop);
}

gameLoop();
</script>
</body>
</html>
